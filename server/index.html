<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>fodmap</title>
  </head>
  <body>
    <label for="file-camera">Take a picture</label>
    <input type="file" accept="image/*" capture="environment" id="file-camera">
    <br>
    <label for="file-upload">Upload a photo</label>
    <input type="file" accept="image/*" id="file-upload">

    <canvas id="canvas" width="640" height="480"></canvas>

    <script>
        const uploadFiles = (files) => {
            let photo = files[0]
            let formData = new FormData();
            formData.append("photo", photo);
            let xhr = new XMLHttpRequest();
            xhr.open("POST", '/upload/image');
            xhr.send(formData);
        };

        const fileInput = document.getElementById('file-camera');
        fileInput.addEventListener('change', (e) => {
            uploadFiles(e.target.files);
            context.drawImage(e.target.files[0], 0, 0, 640, 480);
        });

        // Elements for taking the snapshot
        var canvas = document.getElementById('canvas');
        var context = canvas.getContext('2d');
    </script>
  </body>
</html>